# ğŸ“Š VTTech TMTaza - BÃ¡o cÃ¡o Sync Dá»¯ liá»‡u

> **NgÃ y sync**: 25/12/2025 00:01  
> **Há»‡ thá»‘ng**: TMTaza (tmtaza.vttechsolution.com)  
> **User**: ittest123 (ID: 324) - it test

---

## ğŸ¯ Tá»•ng quan

| Metric | GiÃ¡ trá»‹ |
|--------|---------|
| **Tá»•ng records** | ~12,847 |
| **Tá»•ng file size** | ~3.2 MB |
| **Endpoints hoáº¡t Ä‘á»™ng** | 35+ |
| **Warehouse records** | 2,821 |
| **Thá»i gian sync** | ~20 giÃ¢y |

---

## ğŸ’° DOANH THU NÄ‚M 2025 (REAL-TIME)

### Tá»•ng quan
| Metric | GiÃ¡ trá»‹ |
|--------|---------|
| **Doanh thu nÄƒm 2025** | **98,596,850,916 VND (~98.6 tá»·)** |
| **Doanh thu hÃ´m nay (24/12)** | **141,483,999 VND (~141.5 triá»‡u)** |
| **Tá»•ng khÃ¡ch hÃ ng má»›i 2025** | 21,871 |
| **Tá»•ng lá»‹ch háº¹n 2025** | 106,287 |

### Theo chi nhÃ¡nh (Year-to-date)

| # | Chi nhÃ¡nh | Doanh thu (VND) | % |
|---|-----------|-----------------|---|
| 1 | TAZA Skin Clinic ÄÃ  Náºµng | 20,259,024,998 | 20.5% |
| 2 | Building Timona CMT8 | 16,812,113,696 | 17.0% |
| 3 | Taza Skin Clinic Quáº­n 10 | 12,577,098,000 | 12.8% |
| 4 | Taza Skin Clinic Nha Trang | 11,660,709,897 | 11.8% |
| 5 | Taza Skin Clinic GÃ² Váº¥p | 8,939,360,552 | 9.1% |
| 6 | Timona GÃ² Váº¥p | 7,099,041,500 | 7.2% |
| 7 | Timona Thá»§ Äá»©c | 6,234,209,349 | 6.3% |
| 8 | Taza Skin Clinic Thá»§ Äá»©c | 5,358,857,000 | 5.4% |
| 9 | Timona Nha Trang | 3,324,754,000 | 3.4% |
| 10 | Timona ÄÃ  Náºµng | 3,281,276,000 | 3.3% |
| 11 | Chi nhÃ¡nh Hderma | 1,093,621,425 | 1.1% |
| 12 | Taza Skin Clinic BÃ¬nh TÃ¢n | 969,050,000 | 1.0% |
| 13 | Timona BÃ¬nh TÃ¢n | 727,975,000 | 0.7% |
| 14 | Taza Skin Clinic TÃ¢n PhÃº | 169,619,999 | 0.2% |
| 15 | Timona TÃ¢n PhÃº | 89,569,500 | 0.1% |
| 16 | VÄƒn PhÃ²ng | 570,000 | 0.0% |
| 17 | Timona Quáº­n 10 | 0 | 0.0% |

---

## ï¿½ Master Data (8,217 records)

### Báº£ng dá»¯ liá»‡u chÃ­nh

| # | Báº£ng | MÃ´ táº£ | Records | Tráº¡ng thÃ¡i |
|---|------|-------|---------|------------|
| 1 | `branches` | Chi nhÃ¡nh | 17 | âœ… |
| 2 | `teeth_data` | Dá»¯ liá»‡u rÄƒng (Dental) | 32 | âœ… |
| 3 | `services` | Dá»‹ch vá»¥ | 1,728 | âœ… |
| 4 | `service_groups` | NhÃ³m dá»‹ch vá»¥ | 86 | âœ… |
| 5 | `employees` | NhÃ¢n viÃªn | 1,620 | âœ… |
| 6 | `users` | User accounts | 1,069 | âœ… |
| 7 | `cities` | Tá»‰nh/ThÃ nh phá»‘ | 34 | âœ… |
| 8 | `districts` | Quáº­n/Huyá»‡n | 34 | âœ… |
| 9 | `countries` | Quá»‘c gia | 242 | âœ… |
| 10 | `wards` | PhÆ°á»ng/XÃ£ | 3,321 | âœ… |
| 11 | `customer_sources` | Nguá»“n khÃ¡ch hÃ ng | 34 | âœ… |

### Dá»¯ liá»‡u má»Ÿ rá»™ng

| Báº£ng | MÃ´ táº£ | Records | Tráº¡ng thÃ¡i |
|------|-------|---------|------------|
| `memberships` | Háº¡ng thÃ nh viÃªn | 6 | âœ… |
| `service_types` | Loáº¡i dá»‹ch vá»¥ | 109 | âœ… |
| `employee_groups` | NhÃ³m nhÃ¢n viÃªn | 37 | âœ… |
| `employees_full` | NV chi tiáº¿t | 1,619 | âœ… |

### ğŸ“¦ Warehouse Data (2,821 records) - NEW!

| Báº£ng | MÃ´ táº£ | Records | Tráº¡ng thÃ¡i |
|------|-------|---------|------------|
| `products` | Sáº£n pháº©m kho | 1,691 | âœ… |
| `unit_changes` | Quy Ä‘á»•i Ä‘Æ¡n vá»‹ | 834 | âœ… |
| `unit_products` | ÄV sáº£n pháº©m | 186 | âœ… |
| `units` | ÄÆ¡n vá»‹ tÃ­nh | 51 | âœ… |
| `material_types` | Loáº¡i váº­t tÆ° | 37 | âœ… |
| `warehouses` | Danh sÃ¡ch kho | 22 | âœ… |

---

## ï¿½ğŸ“ Cáº¥u trÃºc thÆ° má»¥c

```
apivttech/
â”œâ”€â”€ ğŸ“‚ data_export/              # Dá»¯ liá»‡u export (~3.4MB)
â”‚   â”œâ”€â”€ master/                  # Master data (JSON + CSV)
â”‚   â”‚   â”œâ”€â”€ branches_20251224.*
â”‚   â”‚   â”œâ”€â”€ services_20251224.*
â”‚   â”‚   â”œâ”€â”€ employees_20251224.*
â”‚   â”‚   â”œâ”€â”€ users_20251224.*
â”‚   â”‚   â”œâ”€â”€ wards_20251224.*
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ employees/               # NV chi tiáº¿t
â”‚   â”œâ”€â”€ services/                # DV chi tiáº¿t  
â”‚   â””â”€â”€ revenue/                 # Doanh thu
â”‚
â”œâ”€â”€ ğŸ“‚ data_sync/                # Dá»¯ liá»‡u sync (~3.2MB)
â”‚   â”œâ”€â”€ master/
â”‚   â”œâ”€â”€ employees/
â”‚   â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ revenue/
â”‚   â”œâ”€â”€ warehouse/               # âœ… NEW! Warehouse data
â”‚   â”‚   â”œâ”€â”€ products_20251224.json       # 1,691 sáº£n pháº©m
â”‚   â”‚   â”œâ”€â”€ warehouses_20251224.json     # 22 kho
â”‚   â”‚   â”œâ”€â”€ material_types_20251224.json # 37 loáº¡i váº­t tÆ°
â”‚   â”‚   â”œâ”€â”€ units_20251224.json          # 51 Ä‘Æ¡n vá»‹
â”‚   â”‚   â”œâ”€â”€ unit_changes_20251224.json   # 834 quy Ä‘á»•i
â”‚   â”‚   â””â”€â”€ unit_products_20251224.json  # 186 Ä‘Æ¡n vá»‹ SP
â”‚   â”œâ”€â”€ customers/               # âš ï¸ Empty (no permission)
â”‚   â”œâ”€â”€ appointments/            # âš ï¸ Empty (limited access)
â”‚   â”œâ”€â”€ treatments/              # âš ï¸ Empty (no permission)
â”‚   â””â”€â”€ inventory/               # âš ï¸ Empty (no permission)
â”‚
â””â”€â”€ ğŸ“‚ data_daily/               # Dá»¯ liá»‡u cron
    â”œâ”€â”€ master/
    â””â”€â”€ revenue/
```

---

## ğŸ”Œ API Endpoints

### âœ… Endpoints hoáº¡t Ä‘á»™ng (User: ittest123)

#### API trá»±c tiáº¿p
```
POST /api/Author/Login           # ÄÄƒng nháº­p âœ…
POST /api/Home/SessionData       # Master data (táº¥t cáº£) âœ…
```

#### Razor Page Handlers - Customer
```
/Customer/ListCustomer/
  ?handler=Initialize            # Branches, Memberships âœ…
  ?handler=LoadDataTotal         # Revenue summary âœ…
  ?handler=LoadData              # Customer list âš ï¸ Returns 0 (no permission)

/Customer/MainCustomer/          # Customer Detail Page
  ?handler=LoadIni               # Init data âœ… (EmpFull, Tele)
  ?handler=Loadata               # Customer data âš ï¸ Returns 0
  ?handler=LoadCustCare          # Customer care âš ï¸ Returns 0
  ?handler=LoadPaymentInfo       # Payment info âš ï¸ Limited
  ?handler=LoadStatusExtra       # Status extra âš ï¸
  ?handler=LoadCustomerScheduleNext # Next schedule âš ï¸
```

#### Razor Page Handlers - Service/Employee
```
/Service/ServiceList/
  ?handler=LoadInit              # Service init âœ…
  ?handler=LoadataServiceType    # Service types (109) âœ…

/Employee/EmployeeList/
  ?handler=LoadataEmployeeGroup  # Employee groups (37) âœ…
  ?handler=LoadataEmployee       # Employees full (1,619) âœ…
```

#### Razor Page Handlers - Warehouse âœ… NEW!
```
/WareHouse/Material/MaterialList/
  ?handler=LoadataInitialization # Units (51), UnitChange (834) âœ…
  ?handler=LoaddataMaterial      # Material list âš ï¸ Empty
  ?handler=LoadataMaterialType   # Material types (37) âœ…
  ?handler=LoadDataChange        # Unit changes (834) âœ…

/WareHouse/Dash/DashWarehouse/
  ?handler=Initialize            # Warehouses (22) âœ…
  ?handler=LoadData              # Dashboard data âš ï¸ Limited

/WareHouse/Require/RequireList/
  ?handler=Initialize            # Warehouses (22), UnitProduct (186) âœ…
  ?handler=LoadData              # Requirements âš ï¸ Empty
  ?handler=LoadInfo              # Info âš ï¸ Empty

/WareHouse/TreatmentSale/ExportList/
  ?handler=Initialize            # Branch, Product (1691), UnitProduct âœ…
  ?handler=LoadData              # Export data âš ï¸ Empty
```

### âš ï¸ Endpoints vá»›i quyá»n giá»›i háº¡n (user: ittest123)

| Endpoint | Tráº¡ng thÃ¡i | MÃ´ táº£ |
|----------|------------|-------|
| Customer detail | âš ï¸ KhÃ´ng cÃ³ quyá»n | Tráº£ vá» empty/0 |
| Appointments list | âš ï¸ Giá»›i háº¡n | Chá»‰ cÃ³ summary, khÃ´ng cÃ³ detail |
| Material list | âš ï¸ Empty | Cáº§n quyá»n xem chi tiáº¿t kho |
| Warehouse transactions | âš ï¸ Empty | Cáº§n quyá»n kho |
| Treatments | âš ï¸ KhÃ´ng cÃ³ data | Cáº§n quyá»n Ä‘áº·c biá»‡t |

---

## ğŸ› ï¸ Scripts sá»­ dá»¥ng

### 1. Export toÃ n bá»™ dá»¯ liá»‡u
```bash
python3 export_all_data.py
```

### 2. Export theo khoáº£ng ngÃ y
```bash
python3 export_all_data.py --date-from 2025-01-01 --date-to 2025-12-24
```

### 3. Chá»‰ master data
```bash
python3 export_all_data.py --master
```

### 4. Full sync vá»›i discover
```bash
python3 full_sync_crawler.py --discover
```

### 5. Sync hÃ ng ngÃ y (cho cron)
```bash
python3 full_sync_crawler.py --daily
```

### 6. Deep scan táº¥t cáº£ APIs
```bash
python3 deep_scan_api.py
```

---

## ğŸ“ Files Script má»›i

| File | MÃ´ táº£ |
|------|-------|
| `full_sync_crawler.py` | Crawler toÃ n diá»‡n vá»›i nhiá»u options |
| `export_all_data.py` | Export dá»¯ liá»‡u ra CSV/JSON |
| `deep_scan_api.py` | Scan táº¥t cáº£ endpoints cÃ³ thá»ƒ |
| `SYNC_SUMMARY.md` | Tá»•ng há»£p ngáº¯n gá»n |
| `DATA_SYNC_REPORT.md` | BÃ¡o cÃ¡o chi tiáº¿t (file nÃ y) |

---

## âš ï¸ LÆ°u Ã½ quan trá»ng

1. **Quyá»n háº¡n**: User `ittest123` (ID: 324) cÃ³ cÃ¡c quyá»n:
   - âœ… Xem master data (chi nhÃ¡nh, dá»‹ch vá»¥, nhÃ¢n viÃªn)
   - âœ… Xem warehouse master data (products, units, warehouses)
   - âœ… Xem bÃ¡o cÃ¡o doanh thu (LoadDataTotal)
   - âš ï¸ KhÃ´ng cÃ³ quyá»n xem chi tiáº¿t khÃ¡ch hÃ ng (LoadData returns 0)
   - âš ï¸ KhÃ´ng cÃ³ quyá»n xem danh sÃ¡ch lá»‹ch háº¹n
   - âš ï¸ KhÃ´ng cÃ³ quyá»n xem transactions kho

2. **Báº£o máº­t**: Credentials - khÃ´ng chia sáº» cÃ´ng khai

3. **Rate limiting**: ~20 requests/phÃºt

4. **Date range**: Tá»‘i Ä‘a 31 ngÃ y/query

---

## ğŸ“ ThÃ´ng tin ká»¹ thuáº­t

### Authentication (Admin Full Access)
```json
{
  "username": "ittest123",
  "password": "ittest123",
  "passwordcrypt": "",
  "from": "",
  "sso": "",
  "ssotoken": ""
}
```

### Response format
- Responses Ä‘Æ°á»£c nÃ©n: Base64 + GZip
- Cáº§n decompress trÆ°á»›c khi parse JSON

### XSRF Token
- Razor Pages yÃªu cáº§u XSRF token
- Láº¥y tá»« hidden input `__RequestVerificationToken`

---

*Generated: 24/12/2025 22:22*

---

## ğŸ“Š ÄÃNH GIÃ TÃNH TOÃ€N Váº¸N VÃ€ Äáº¦Y Äá»¦ Cá»¦A Há»† THá»NG

### ğŸŸ¢ Dá»¯ liá»‡u HOÃ€N CHá»ˆNH (100%)

| Module | Tráº¡ng thÃ¡i | Ghi chÃº |
|--------|------------|---------|
| **Master Data** | âœ… Äáº§y Ä‘á»§ | 11 báº£ng, 8,217 records |
| **Branches** | âœ… Äáº§y Ä‘á»§ | 17 chi nhÃ¡nh |
| **Services** | âœ… Äáº§y Ä‘á»§ | 1,728 dá»‹ch vá»¥, 86 nhÃ³m, 109 loáº¡i |
| **Employees** | âœ… Äáº§y Ä‘á»§ | 1,620 nhÃ¢n viÃªn, 37 nhÃ³m |
| **Users** | âœ… Äáº§y Ä‘á»§ | 1,069 tÃ i khoáº£n |
| **Revenue Summary** | âœ… Äáº§y Ä‘á»§ | Doanh thu theo chi nhÃ¡nh/ngÃ y |
| **Geography** | âœ… Äáº§y Ä‘á»§ | 242 quá»‘c gia, 34 tá»‰nh, 3,321 phÆ°á»ng |
| **Warehouse Master** | âœ… Äáº§y Ä‘á»§ | 1,691 products, 22 kho, 37 loáº¡i VT |
| **Units** | âœ… Äáº§y Ä‘á»§ | 51 Ä‘Æ¡n vá»‹, 834 quy Ä‘á»•i |

### ğŸŸ¡ Dá»¯ liá»‡u CÃ“ GIá»šI Háº N (Cáº§n quyá»n Ä‘áº·c biá»‡t)

| Module | Tráº¡ng thÃ¡i | LÃ½ do |
|--------|------------|-------|
| **Customer Detail** | âš ï¸ Returns 0 | User khÃ´ng cÃ³ quyá»n xem chi tiáº¿t khÃ¡ch hÃ ng |
| **Customer Care** | âš ï¸ Returns 0 | Cáº§n quyá»n CSKH |
| **Appointments List** | âš ï¸ Chá»‰ count | Handler tráº£ vá» string, khÃ´ng cÃ³ list |
| **Treatments** | âš ï¸ KhÃ´ng cÃ³ data | Cáº§n quyá»n bÃ¡c sÄ©/Ä‘iá»u trá»‹ |
| **Warehouse Transactions** | âš ï¸ Empty tables | Cáº§n quyá»n quáº£n lÃ½ kho |
| **Material List** | âš ï¸ Empty | Cáº§n quyá»n xem chi tiáº¿t váº­t tÆ° |

### ğŸ” PHÃ‚N TÃCH QUYá»€N USER `ittest123`

**Login Response:**
```json
{
  "ID": 324,
  "UserName": "ITTEST123",
  "FullName": "it test"
}
```

**Káº¿t luáº­n vá» quyá»n:**
- User `ittest123` lÃ  **user test** vá»›i quyá»n háº¡n cháº¿
- CÃ³ quyá»n **xem master data** (services, employees, branches) âœ…
- CÃ³ quyá»n **xem warehouse master** (products, units, warehouses) âœ…
- **KHÃ”NG** cÃ³ quyá»n xem chi tiáº¿t khÃ¡ch hÃ ng (LoadData returns 0)
- **KHÃ”NG** cÃ³ quyá»n xem warehouse transactions
- **KHÃ”NG** cÃ³ quyá»n xem customer care, treatments

### ğŸ“ˆ ÄÃNH GIÃ Tá»”NG THá»‚

| TiÃªu chÃ­ | Äiá»ƒm | ÄÃ¡nh giÃ¡ |
|----------|------|----------|
| **TÃ­nh toÃ n váº¹n dá»¯ liá»‡u** | 9/10 | Master data + Warehouse master Ä‘áº§y Ä‘á»§ |
| **Äá»™ chÃ­nh xÃ¡c** | 10/10 | Dá»¯ liá»‡u khá»›p vá»›i há»‡ thá»‘ng gá»‘c |
| **Äá»™ cáº­p nháº­t** | 10/10 | Sync real-time, dá»¯ liá»‡u má»›i nháº¥t |
| **Pháº¡m vi phá»§** | 6/10 | Thiáº¿u customer detail, warehouse transactions |
| **Kháº£ nÄƒng má»Ÿ rá»™ng** | 8/10 | Scripts há»— trá»£ sync tá»± Ä‘á»™ng |

### ğŸ’¡ Äá»€ XUáº¤T Cáº¢I THIá»†N

1. **NÃ¢ng cáº¥p quyá»n user**: LiÃªn há»‡ VTTech Ä‘á»ƒ cáº¥p quyá»n:
   - Xem danh sÃ¡ch khÃ¡ch hÃ ng chi tiáº¿t (Customer/ListCustomer LoadData)
   - Xem customer care data
   - Xem warehouse transactions (xuáº¥t/nháº­p kho)
   - Truy cáº­p module Ä‘iá»u trá»‹

2. **ThÃªm endpoints Ä‘Ã£ discovered**:
   - `/Customer/MainCustomer/?handler=Loadata` - Customer detail (cáº§n quyá»n)
   - `/WareHouse/Material/MaterialList/?handler=LoaddataMaterial` - Material list
   - `/WareHouse/Require/RequireList/?handler=LoadData` - YÃªu cáº§u xuáº¥t kho

3. **Warehouse Endpoints má»›i**:
   ```
   /WareHouse/Material/MaterialList/     - Quáº£n lÃ½ váº­t tÆ°
   /WareHouse/Dash/DashWarehouse/        - Dashboard kho
   /WareHouse/Require/RequireList/       - YÃªu cáº§u xuáº¥t kho
   /WareHouse/TreatmentSale/ExportList/  - Xuáº¥t kho Ä‘iá»u trá»‹
   /WareHouse/Setting/WarehouseGeneral/  - CÃ i Ä‘áº·t kho
   ```

### âœ… Káº¾T LUáº¬N

Há»‡ thá»‘ng VTTech TMTaza vá»›i user `ittest123` cÃ³ thá»ƒ sync Ä‘Æ°á»£c:
- **8,217 records** Master data
- **2,821 records** Warehouse master data
- **17 chi nhÃ¡nh**, **22 kho**
- **1,728 dá»‹ch vá»¥**, **1,691 sáº£n pháº©m**
- **1,620 nhÃ¢n viÃªn**, **1,069 users**

Dá»¯ liá»‡u Ä‘Æ°á»£c sync Ä‘áº§y Ä‘á»§ á»Ÿ má»©c **master data**, nhÆ°ng cáº§n thÃªm quyá»n Ä‘á»ƒ truy cáº­p **transaction data** (customer detail, warehouse transactions).

---

## ğŸ“Š WAREHOUSE ENDPOINTS ANALYSIS

### Discovered Endpoints

| Page | Handler | Data | Status |
|------|---------|------|--------|
| MaterialList | LoadataInitialization | Units, UnitChange | âœ… 885 records |
| MaterialList | LoadataMaterialType | Material Types | âœ… 37 records |
| MaterialList | LoaddataMaterial | Material List | âš ï¸ Empty |
| DashWarehouse | Initialize | Warehouses | âœ… 22 records |
| DashWarehouse | LoadData | Dashboard | âš ï¸ Limited |
| RequireList | Initialize | Warehouses, UnitProduct | âœ… 208 records |
| RequireList | LoadData | Requirements | âš ï¸ Empty |
| ExportList | Initialize | Branch, Product, UnitProduct | âœ… 1,894 records |
| ExportList | LoadData | Exports | âš ï¸ Empty |

### Warehouse Data Summary

| Data Type | Records | Description |
|-----------|---------|-------------|
| Products | 1,691 | Sáº£n pháº©m trong kho |
| Unit Changes | 834 | Quy Ä‘á»•i Ä‘Æ¡n vá»‹ |
| Unit Products | 186 | ÄÆ¡n vá»‹ sáº£n pháº©m |
| Units | 51 | ÄÆ¡n vá»‹ tÃ­nh |
| Material Types | 37 | Loáº¡i váº­t tÆ°/thuá»‘c |
| Warehouses | 22 | Danh sÃ¡ch kho |

### Warehouse List (22 kho)
```
1. Kho Quáº­n 10
2. Kho GÃ² Váº¥p  
3. Kho Nha Trang
4. Kho ÄÃ  Náºµng
5. Kho Tá»•ng
6. Kho Thá»§ Äá»©c
7. Kho Test
10. Kho há»c viá»‡n quáº­n 10
11. Kho há»c viá»‡n Thá»§ Äá»©c
12. Kho há»c viá»‡n GÃ² Váº¥p
13. Kho há»c viá»‡n Nha Trang
14. Kho há»c viá»‡n ÄÃ  Náºµng
15. Kho Online
16. Timona Academy Chi NhÃ¡nh HÃ  Ná»™i
17. Kho Building Timona CMT8
... (vÃ  cÃ¡c kho khÃ¡c)
```
